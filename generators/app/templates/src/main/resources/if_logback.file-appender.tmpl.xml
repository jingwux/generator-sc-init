<?xml version="1.0" encoding="UTF-8"?>

<included>
    <%
        if (apm === 'skywalking') {
            print(`
    <property name="FILE_LOG_PATTERN" value="[%tid] \${FILE_LOG_PATTERN}"/>
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
            <layout class="org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout">
                <pattern>\${FILE_LOG_PATTERN}</pattern>
            </layout>
        </encoder>
        <file>\${LOG_FILE}</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
            <fileNamePattern>\${LOG_FILE}.%d{yyyy-MM-dd}.%i.gz</fileNamePattern>
            <maxFileSize>\${LOG_FILE_MAX_SIZE\:-10MB}</maxFileSize>
            <maxHistory>\${LOG_FILE_MAX_HISTORY\:-0}</maxHistory>
        </rollingPolicy>
    </appender>
            `)
        } else {
            print(`
    <include resource="org/springframework/boot/logging/logback/file-appender.xml" />
            `)
        }
    %>
</included>
